

# ====== Import Things ======
import os
import pandas as pd
from Bio import SeqIO
from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord


# ================================ Main =========================================

# path to consensus file
consensus = "/Users/katykrupinsky/Documents/College/03-UM/Research/Lauring Lab/Bottlenecks/Brisbane_H1N1_2019.noWater.all.consensus.fasta"
# sites we need
sites = (24,38,67,122,137,164,187,199,208,215,247,301,302,303,311,313,323,360,415,426,441,450,454,499,549,576,608,615,682,739,837,871,872,875,906,990,1051,1058,1062,1137,1201,1212,1239,1281,1308,1350,1449,1491,1554,1564,1629,1632,1677,1698,1710,1729,1752,1763,1818,1832,1923,1926,1995,1997,2001,2004,2007,2010,2012,2013,2019,2023,2061,2071,2087,2088,2092,2094,2122,2123,2142,2143,2158,2166,2174,2180,2191,2201,2210,2218,2541,2542,2589,2593,2603,2606,2612,2615,2623,2679,2699,2715,2755,2784,2851,2854,2885,2957,2964,3019,3259,3274,3295,3397,3498,3511,3537,3731,3743,3780,3847,3891,3894,4015,4105,4108,4124,4160,4167,4181,4204,4264,4266,4270,4274,4294,4446,4451,4452,4582,4592,4717,4738,4778,4873,4879,4910,4911,4913,4916,4937,4964,4976,4980,5054,5072,5079,5080,5138,5217,5320,5336,5345,5387,5464,5623,5737,5804,5945,5993,6023,6032,6076,6131,6185,6218,6263,6308,6320,6438,6459,6502,6522,6524,6529,6559,6584,6616,6635,6643,6666,6684,6688,6697,6735,6778,6950,6995,7011,7014,7035,7084,7124,7149,7152,7176,7195,7250,7280,7348,7353,7389,7425,7446,7597,7601,7603,7628,7637,7660,7673,7680,7688,7695,7702,7715,7731,7753,7763,7785,7790,7794,7812,7888,7934,7995,8036,8040,8118,8120,8145,8164,8173,8196,8210,8211,8242,8245,8253,8262,8383,8408,8467,8472,8611,8754,8844,8852,8887,8927,8993,9010,9089,9142,9163,9376,9500,9539,9595,9616,9688,9722,9745,9822,9891,9898,9990,9997,10024,10072,12451,12485,12538,12541,12573,12578,12585,12587,12601,12608,12613,12616,12649,12655,12797,12808,12825,12839,12935,12944,12955,13016,13034,13052,13078,13097,13278,13279,13323,13360,13371,13375,13401)
# output file name
f = open("consensus_allele_forsnv_sites_test.txt", "a")
header = "sample Allele POS"
f.write (header + '\n')

for record in SeqIO.parse(consensus, "fasta"):
    for site in sites:
         bp=(record.id, record.seq[site-1], site)
         f.write (' '.join(str(s) for s in bp) + '\n')
f.close () 
